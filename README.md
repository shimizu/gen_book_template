# Vivliostyle CLI 電子書籍作成テンプレート

このリポジトリは、**Claude Code**と[Vivliostyle CLI](https://docs.vivliostyle.org/#/vivliostyle-cli)を組み合わせて電子書籍を効率的に作成するためのテンプレートです。

## 🤖 Claude Codeとの連携

**Claude Code**（Anthropic社のAIアシスタント）を使用することで、以下の作業を自動化・効率化できます：

- 📝 Markdownコンテンツの自動生成と編集
- ⚙️ 設定ファイル（vivliostyle.config.js）の最適化
- 🎨 カスタムCSS作成とスタイル調整
- 🔧 ビルドエラーの自動修正
- 📊 章構成の提案と整理
- 🖼️ 画像配置とレイアウトの最適化

### AIアシスタントによる書籍制作の特徴

- **自動化された品質管理**: コード品質、スタイル一貫性、構造整合性を自動チェック
- **インテリジェントな提案**: 最適なテーマ選択、レイアウト改善、コンテンツ構成の提案
- **効率的なトラブルシューティング**: ビルドエラーや設定問題の迅速な解決
- **最新情報の活用**: Vivliostyle機能とベストプラクティスの自動適用

Markdownで書いた原稿から、PDF、EPUB、WebPublicationの各形式で高品質な書籍を出力できます。

## 🚀 クイックスタート（Claude Code推奨）

### 1. 前提条件

- **Claude Code**（Anthropic AIアシスタント）
- Node.js v16 以上
- npm または yarn

### 2. Claude Codeでのセットアップ

**Claude Codeに以下のように依頼してください：**

```
「Vivliostyle電子書籍プロジェクトをセットアップして、サンプル書籍をビルドしてください」
```

Claude Codeが自動的に以下を実行します：
- 依存関係のインストール確認
- 設定ファイルの検証
- 初回ビルドとプレビュー起動
- エラーがあれば自動修正

### 3. AI支援による書籍作成

**コンテンツ作成：**
```
「『[テーマ]』について第1章を作成して、技術書らしい構成にしてください」
```

**スタイル調整：**
```
「フォントサイズを調整して、コードブロックのハイライトを改善してください」
```

**ビルドと品質チェック：**
```
「全形式でビルドして、エラーがあれば修正してください」
```

## 📁 ディレクトリ構造

```
/
├── README.md                   # このファイル
├── package.json                # npm設定とスクリプト
├── vivliostyle.config.js       # Vivliostyle設定ファイル
├── content/                    # 書籍コンテンツ
│   ├── 02-preface.md          # まえがき
│   ├── 03-chapter1.md         # 第1章
│   ├── 04-chapter2.md         # 第2章
│   └── 99-appendix.md         # 付録
├── assets/                     # 画像・CSS等のアセット
│   ├── images/                # 画像ファイル
│   │   └── cover.png          # 表紙画像
│   └── css/                   # スタイルシート
│       └── custom.css         # カスタムCSS
├── output/                     # 生成される書籍ファイル
└── themes/                     # Vivliostyleテーマ（自動生成）
```

## ⚙️ カスタマイズ方法（Claude Code活用）

### 1. AI支援による基本設定

**Claude Codeへの依頼例：**
```
「書籍タイトルを『[あなたのタイトル]』、著者を『[あなたの名前]』に変更して、
適切な設定を vivliostyle.config.js に反映してください」
```

Claude Codeが自動的に：
- 設定ファイルの適切な編集
- メタデータの整合性チェック
- ベストプラクティスの適用

### 2. インテリジェントな章構成

**構成提案を依頼：**
```
「『[書籍テーマ]』について、読者層『[ターゲット]』向けの
章構成を提案して設定してください」
```

Claude Codeが提供：
- 論理的な章立て提案
- 適切なファイル命名
- 目次構造の最適化
- エントリー配列の自動生成

### 3. スマートスタイリング

**デザイン要求例：**
```
「プロフェッショナルな技術書らしいスタイルに調整して、
コードブロックとテーブルのデザインを改善してください」
```

AIによる自動調整：
- カラーパレットの提案と適用
- タイポグラフィの最適化
- レスポンシブレイアウト対応
- 印刷用スタイルの調整

### 4. テーマの知識ベース選択

**最適テーマの相談：**
```
「『[書籍の内容・目的]』に最適なVivliostyleテーマを
推奨して設定してください」
```

Claude Codeの支援：
- 要件に基づくテーマ推奨
- カスタマイズの必要性判断
- テーマ固有の設定最適化
- 複数テーマの比較提案

## 📝 執筆のヒント（Claude Code協働執筆）

### AI支援による効率的な執筆

**コンテンツ生成の依頼例：**
```
「『[トピック]』について、初心者向けに分かりやすく
第3章を執筆してください。コード例と図表を含めてください」
```

**Claude Codeの執筆支援：**
- 技術的に正確なコンテンツ生成
- 適切な見出し構造の提案
- VFM記法の最適活用
- 読者レベルに応じた説明調整

### インテリジェントなMarkdown活用

**高度な記法の自動適用：**
```
「数式を含む技術説明を追加して、LaTeX記法で
美しく表示されるようにしてください」
```

Claude Codeが自動で：
- 適切な数式記法の選択と実装
- コードブロックのシンタックスハイライト設定
- 表組みの構造最適化
- 脚注の適切な配置

### コンテンツ品質の自動向上

**文章校正とブラッシュアップ：**
```
「第1章の文章を技術書らしく校正して、
読みやすさとプロフェッショナル感を向上させてください」
```

**構造最適化：**
```
「全章の見出し構造を見直して、論理的な流れに
再構成してください」
```

### レイアウト自動最適化

**画像配置の知的判断：**
```
「図表を効果的に配置して、改ページ制御を
最適化してください」
```

AI による自動調整：
- 画像サイズとキャプションの最適化
- 改ページ位置の知的判断
- テキストと図表のバランス調整
- 印刷レイアウトの考慮

## 🛠️ 使用可能なコマンド

```bash
# プレビュー（ブラウザで確認）
npm run preview

# PDF生成
npm run build:pdf

# EPUB生成
npm run build:epub

# WebPublication生成
npm run build:webpub

# 全形式生成
npm run build:all

# 出力ファイルのクリーンアップ
npm run clean
```

## 🎨 出力形式の特徴

### PDF
- 印刷に適した高品質な出力
- ページ番号、ヘッダー・フッター対応
- 図表の精密な配置制御

### EPUB
- 電子書籍リーダー対応
- リフロー可能なレイアウト
- 目次ナビゲーション

### WebPublication
- Webブラウザで閲覧可能
- レスポンシブデザイン
- インタラクティブな要素に対応

## 🔧 トラブルシューティング

### よくある問題

**Q: 日本語フォントが表示されない**
A: `assets/css/custom.css`でフォント設定を確認してください

**Q: 画像が表示されない**
A: 画像ファイルのパスが正しいか確認し、`copyAsset`設定をチェックしてください

**Q: PDFが生成されない**
A: Node.jsのメモリ不足の可能性があります。以下を試してください：
```bash
node --max-old-space-size=4096 ./node_modules/.bin/vivliostyle build
```

### デバッグ方法

1. `npm run preview`でプレビューを確認
2. ブラウザの開発者ツールでCSS/レイアウトを検証
3. エラーログの確認

## 📚 参考資料

### 公式ドキュメント
- [Vivliostyle CLI Documentation](https://docs.vivliostyle.org/#/vivliostyle-cli)
- [VFM (Vivliostyle Flavored Markdown)](https://vivliostyle.github.io/vfm/)
- [Vivliostyle Themes](https://vivliostyle.github.io/themes/)
- [CSS Paged Media](https://www.w3.org/TR/css-page-3/)


## 🤝 コントリビューション

改善提案やバグレポートは、GitHubのIssuesまでお願いします。Pull Requestも歓迎です。

---

**Happy Writing! 📖✨**